version: '3.9'
# usage:
# docker-compose up -d
# docker-compose down
services:
  coyote3_app:
    container_name: coyote3_app
    build:
      context: .
      dockerfile: Dockerfile
      network: host
      target: coyote3_app
    image: coyote3:3.0.0.alpha-3
    network_mode: bridge
    ports:
      - "8815:5000"
    environment:
      - PYHTONDONTWRITEBYTECODE=1
      - PYTHONUNBUFFERED=1
      - FLASK_APP=wsgi.py
      - FLASK_MONGO_HOST=localhost
      - FLASK_MONGO_PORT=27017
      - FLASK_DEBUG=1
      - SCRIPT_NAME=''
      - TZ=Europe/Stockholm
    restart: always
    volumes:
      - ".git:/app/.git"
      - "./coyote:/app/coyote"
      - "./config:/app/config"
      - "./logs:/app/logs"
      - "./config.py:/app/config.py"
      - "./wsgi.py:/app/wsgi.py"
      - "./gunicorn_config.py:/app/gunicorn_config.py"
      - "./logging_setup.py:/app/logging_setup.py"
    command: "python3 wsgi.py"

