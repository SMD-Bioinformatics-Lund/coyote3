version: "3.9"
# usage:
# docker-compose up -d
# docker-compose down
services:
  coyote3_saile:
    container_name: coyote3_saile
    image: coyote3:3.0.0-saile # only this now
    ports:
      - "8511:8000" # external:internal
    env_file:
      - .saile.env
    environment:
      - PYTHONDONTWRITEBYTECODE=1
      - PYTHONUNBUFFERED=1
      - FLASK_APP=wsgi.py
      - FLASK_DEBUG=1
      - TZ=Europe/Stockholm
    restart: always
    volumes:
      - ".git:/app/.git"
      - "./coyote:/app/coyote"
      - "./config:/app/config"
      - "./logs:/app/logs"
      - "./docs:/app/docs"
      - "./config.py:/app/config.py"
      - "./wsgi.py:/app/wsgi.py"
      - "./gunicorn.conf.py:/app/gunicorn.conf.py"
      - "./logging_setup.py:/app/logging_setup.py"
      - "./CHANGELOG.md:/app/CHANGELOG.md"
      - "./README.md:/app/README.md"
      - "./LICENSE.txt:/app/LICENSE.txt"
      - "/access:/access"
      - "/media:/media"
      - "/data:/data"
      - "/fs1:/fs1"
    command: "python3 wsgi.py"

  redis_saile:
    container_name: redis_saile
    image: ramsainanduri/redis:7.4.3
    ports:
      - "8512:6379" # external:internal
    environment:
      - ALLOW_EMPTY_PASSWORD=yes
    restart: unless-stopped
    privileged: true
