{% extends "layout.html" %}
{% block title %}Admin Panel{% endblock %}

{% block body %}
<div class="flex w-full h-full overflow-hidden bg-blue-50">
  <main class="flex-1 bg-transparent overflow-y-auto p-4 flex flex-col">

    {% set cards = [] %}
    {% include "partials/admin_links_data.jinja" %}
    {% set card_color_classes = {
      'blue':   {'border': 'border-l-8 border-blue-600',   'bg': 'bg-blue-50 hover:bg-blue-200'},
      'yellow': {'border': 'border-l-8 border-yellow-600', 'bg': 'bg-yellow-50 hover:bg-yellow-200'},
      'pink':   {'border': 'border-l-8 border-pink-600',   'bg': 'bg-pink-50 hover:bg-pink-200'},
      'orange': {'border': 'border-l-8 border-orange-600', 'bg': 'bg-orange-50 hover:bg-orange-200'},
      'red':    {'border': 'border-l-8 border-red-600',    'bg': 'bg-red-50 hover:bg-red-200'},
      'green':  {'border': 'border-l-8 border-green-600',  'bg': 'bg-green-50 hover:bg-green-200'},
      'indigo': {'border': 'border-l-8 border-indigo-600', 'bg': 'bg-indigo-50 hover:bg-indigo-200'},
      'purple': {'border': 'border-l-8 border-purple-600', 'bg': 'bg-purple-50 hover:bg-purple-200'},
      'brown':  {'border': 'border-l-8 border-brown-600',  'bg': 'bg-brown-50 hover:bg-brown-200'}
    } %}

    <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-6">
      {% for card in cards %}
        {% set is_allowed = has_access(card.permission, card.min_role, card.min_level) %}
        {% set color_classes = card_color_classes.get(card.color, {'border': 'border-l-8 border-gray-600', 'bg': 'bg-gray-50 hover:bg-gray-200'}) %}
        {% set border_color = color_classes.border %}
        {% set bg_class = color_classes.bg %}
        {% set opacity_class = 'opacity-50 cursor-not-allowed' if not is_allowed else '' %}

        {% if is_allowed %}
          <a href="{{ card.url }}"
              class="card {{ bg_class }} rounded-xl shadow-md p-6 text-center cursor-pointer transform transition-all duration-200 hover:translate-x-1 {{ border_color }}">
            <img src="{{ url_for('static', filename='icons/heroicons_outline_24/' ~ card.icon) }}"
                  alt="{{ card.title }} Icon"
                  class="mx-auto mb-2 h-6 w-6">
            <h3 class="text-base font-semibold">{{ card.title }}</h3>
            <p class="text-xs text-gray-600">{{ card.desc }}</p>
          </a>
        {% else %}
          <div class="card {{ bg_class }} {{ opacity_class }} rounded-xl shadow-md p-6 text-center transform transition-all duration-200 {{ border_color }} hidden"
                title="You do not have access to this section.">
            <img src="{{ url_for('static', filename='icons/heroicons_outline_24/' ~ card.icon) }}"
                  alt="{{ card.title }} Icon"
                  class="mx-auto mb-2 h-6 w-6">
            <h3 class="text-base font-semibold">{{ card.title }}</h3>
            <p class="text-xs text-gray-600">{{ card.desc }}</p>
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </main>
</div>
{% endblock %}
