{% extends "report_layout.html" %}
{% block body %}

{% set germline = True if sample.name == "11400-19" %}

{% if pdf != 1 %}
<div style="background-color:#FCC; border:1px solid #EAA; width:300px; text-align:center; padding:20px; margin:10px 10px 30px 10px;">
<b>*** PREVIEW OF REPORT ***</b><br><br>
<a target="_blank" class="button" href="pdf/{{sample.name}}">Finalize report</a>
</div>

{% endif %}
{% if "gms_myeloid" in group or "myeloid_GMSv1" in group %}
  {% if "snabbsvar" in clarity["Diagnosis"] %}
    {% if sample.num_samples == 2 %}
      <span class="report_header">Analysrapport, myeloisk genpanel (NGS): fullständig parad analys - {{ sample.name }}</span>
    {% else %}
      <span class="report_header">Analysrapport, myeloisk genpanel (NGS): preliminär oparad analys - {{ sample.name }}</span>
    {% endif %}
  {% else %}
    <span class="report_header">Analysrapport, myeloisk genpanel (NGS) - {{ sample.name }}</span>
  {% endif %}
{% elif assay=="myeloid" %}
<span class="report_header">Analysrapport, myeloisk genpanel (NGS) - {{ sample.name }}</span>
{% elif assay=="swea" %}
<span class="report_header">Analysrapport, BRCA-panel (NGS) - {{ sample.name }}</span>
{% elif assay=="gmsonco" %}
<span class="report_header">Analysrapport, panel inför PARP-hämmare (NGS) - {{ sample.name }}</span>
{% elif assay=="solid" %}
<span class="report_header">Analysrapport, solid tumörpanel (NGS) - {{ sample.name }}</span>
{% else %}
<span class="report_header">Analysrapport, myeloisk panel (NGS) - {{ sample.name }}</span>
{% endif %}

<div class="report_div">
  <table class='report_general'> 
    <tr>
      <td class="top_report_key">Patientnamn</td><td class="top_report_val">{{clarity["Patient Name"]}}</td>
    </tr>
    <tr>
      <td class="top_report_key">Personnummer</td><td class="top_report_val">{{clarity["Personal Identity Number"]}}</td>
    </tr>
    <tr>
      <td class="top_report_key">Prov-ID</td><td class="top_report_val">{{ sample.name }}; {{tumor_creation_date}}{% if not germline and clarity["Paired Sample Name"] and sample.num_samples == 2 %} (Kontrollprov: {{clarity["Paired Sample Name"]}}; {{tumor_normal_creation_date}}){% endif %}</td>
    </tr>
    <tr>
      <td class="top_report_key">Registreringsdatum</td><td class="top_report_val">{{ clarity["Date of arrival"] }}</td>
    </tr>
    <tr>

      {% if assay=="swea" or assay=="gmsonco" %}
      <td class="top_report_key">Provtyp</td><td class="top_report_val">Tumörprov {% if "Tissue" in clarity and clarity["Tissue"] == "FFPE" %}(FFPE){% endif %}{% if clarity["Paired Sample Name"] %} / Blodprov{% endif %}, {{ clarity["Nucleotide Type"] }}</td>
      <!-- <td class="top_report_key">Provtyp</td><td class="top_report_val">Blodprov, {{ clarity["Nucleotide Type"] }}</td> -->
      {% else %}
      <td class="top_report_key">Provtyp</td><td class="top_report_val">{{ clarity["Tissue"] }} / {{ clarity["Nucleotide Type"] }}</td>
      {% endif %}
    </tr>
    {% if assay != "swea" and assay != "gmsonco" %}
    <tr>
      <td class="top_report_key">Frågeställning</td>
      <td class="top_report_val">
        {% if assay == "myeloid" %}
          {% if sample.num_samples == 2 %}
            Hematologisk neoplasi
          {% else %}
            {{ clarity["Diagnosis"] }}
          {% endif %}
        {% elif assay == "solid" %}
          {% if 'subpanel' in sample %}
            {% if sample.subpanel == "BP" %}
            Bröst-Pilot
            {% else %}
            {{sample.subpanel}}
            {% endif %}
          {% endif %}
        {% endif %}
      </td>
    </tr>
    {% endif %}
    <tr>
      <td class="top_report_key">Rapportdatum</td><td class="top_report_val">{{ report_date }}</td>
    </tr>
    <tr>
      <td class="top_report_key">Analysmetod</td><td class="top_report_val">
	{% if "gms_myeloid" in group or "myeloid_GMSv1" in group %}
	NGS-/MPS-analys med panelen GMS-myeloid v1.0 (191 gener)
	{% elif assay=="myeloid" %}
	NGS-/MPS-analys med Illumina Trusight Myeloid Panel (54 gener)
	{% elif assay=="swea" %}
	SWEA BRCA-panel, endast BRCA1 och BRCA2
	{% elif assay=="gmsonco" %}
	NGS-/MPS-analys med panelen Ärftlig solid cancer v1.0
	{% endif %}
      </td>
    </tr>
    <tr>
      <td class="top_report_key">Analys genomförd av</td>
      <td class="top_report_val">
	{% if assay=="myeloid" %}
	Centrum för molekylär diagnostik (CMD) och Klinisk genetik och patologi
	{% elif assay=="swea" or assay=="gmsonco" %}
	Centrum för molekylär diagnostik (CMD)
	{% endif %}
      </td>
    </tr>
    <tr>
      <td class="top_report_key">Rapport genererad av</td><td class="top_report_val">{{ current_user.fullname }}</td>
    </tr>    
    <tr>
      <td class="top_report_key">Rapport-ID</td><td class="top_report_val">{{ sample.name }}.{% if sample.report_num is defined %}{{ sample.report_num + 1 }}{% else %}1{% endif %}</td>
    </tr>    
  </table>
</div>

<span class="report_header">Analysresultat</span>
  <table class="variant_table">
    <tr>
      <th>Gen</th>
      <th>Variant</th>
      <th>Variantfrekvens</th>
      <th>Klassificering</th>
      {% if assay == "solid" %}
      <th>Hotspot*</th>
      {% endif %}
    </tr>

    {% for var in variants|sort( attribute='classification.class' )  if (var.INFO.selected_CSQ.SYMBOL in dispgenes or dispgenes|length == 0) and not var.blacklist and var.classification.class != 4 and var.classification.class != 999 and not (assay == "gmsonco" and var.classification.class == 3)  %}
      {% set csq = var.INFO.selected_CSQ %}
      <tr>
	<td>{{ csq.SYMBOL }}</td>
	<td>
	  {% set indel_size = var.ALT|length - var.REF|length %}
	  {% if indel_size > 20 or indel_size < -20 %}
	  {{ indel_size }} bp {% if indel_size < 0 %}DEL{% else %}INS{% endif %}
	  {% elif csq.HGVSp|length > 0 %}
	    {{ csq.HGVSp|one_letter_p|unesc }}
	  {% elif csq.HGVSc|length > 0 %}
          {{ csq.HGVSc|unesc }}
	  {% elif var.INFO.SVTYPE is defined %}
	  {{ var.INFO.SVLEN }} bp {{ translation[var.INFO.SVTYPE] }}
	  {% else %}
	  ?
	  {% endif %}	  
	</td>
	<td>
	  {% if var.INFO.SVTYPE is defined and csq.SYMBOL == "FLT3" %}
	  N/A
	  {% else %}
  	    {% for gt in var.GT|sort(attribute='sample') %}
	      {% if gt.type == "case" %}
	        {{ gt.AF|perc_no_dec }}%
              {% endif %}
            {% endfor %}
	  {% endif %}	  
	</td>
	<td>
	  {% if germline %}
	    {% if var.classification.class == 1 %}
	    5 (Patogen)
	    {% endif %}
	  
	  {% else %}
	  {{ class_desc_short[var.classification.class] }}
	  {% endif %}
	</td>
  {% if assay == "solid" %}
  <td>
    {{var.INFO.HOTSPOT|join(', ')|upper}}
  </td>
  {% endif %}
      </tr>
    {% else %}
      <tr><td>Inga detekterade varianter</td></tr>  
    {% endfor %}

  </table>
{% if assay == "solid"%}
* MM:malignt melanom, CO: kolorektal, LU: lunga, GI: gastro-intestinal, CNS: centrala nervsystemet, D: generell solid
{% endif %}
{% if assay == "solid" or assay == "gmsonco"  %}
  <span class="report_header">Kliniskt relevanta genspecifika kopietalsförändringar</span>
  <table class="variant_table">
    <tr><th>Gen(er)</th><th>Storlek</th><th>Typ</th><th>Kopietal</th></tr>
    {% for cnv in cnvs %}
      <tr>
	<td>
	  {% set non_panel_genes = [0] %}
	  
    {% for gene in cnv.genes%}
	    {% if gene.class %}
	      {{gene.gene}}  
	    {% else %}
	      {% if non_panel_genes.append(non_panel_genes.pop()+1) %}{% endif %}
	    {% endif %}
	  {% endfor %}
	  {% if non_panel_genes[0] > 0 %}
	    <font color='#888'>+ {{non_panel_genes[0] }} other genes</font>
	  {% endif %}
	</td>
	<td>{{ cnv.size }} bp</td>
	<td>{% if cnv.ratio > 1 %}AMP{% elif cnv.ratio > 0 %}DUP{% else %}DEL{% endif %}</td>
	<td>{{ 2*(2**cnv.ratio)|round(2) }}</td>
      </tr>
    {% else %}
        <tr><td>Inga detekterade genspecifika kopietalsförändringar. 
          {% if assay == "solid" %}
          {% else %}
          För eventuella större förändringar, se under slutsats
          {% endif %}
        </td></tr> 
    {% endfor %}
  </table>
  {% endif %}
  {% if assay == "solid" %}
  <span class="report_header">Kliniskt relevanta fusioner (DNA)</span>
  <table class="variant_table">
    <tr><th>Gen 1</th><th>Gen 2</th><th>HGVS.p</th></tr>
    {% for tl in translocs %}
      {% set sel_ann = tl.INFO.MANE_ANN or tl.INFO.ANN[0] %}
      {% set genes = sel_ann.Gene_Name.split('&') %}
    
      <tr>
	<td>{{ genes[0] }}</td>
	<td>{{ genes[1] }}</td>
	<td>{{ sel_ann.HGVSp|unesc }}</td>
      </tr>
    {% else %}
      <tr><td>Inga detekterade fusioner</td></tr>  
    {% endfor %}
  </table>
  {% if 1==0 %}
  <span class="report_header">Andra biomarkörer</span>
  <table class="variant_table">
    <tr>
      <th>Markör</th>
      <th>Värde</th>
    </tr>
    {% if  biomarkers and biomarkers.count() > 0 %}
    {% for bio in biomarkers %}
      {% if "MSIS" in bio %}
      <tr>
        <td>
          MSI(Single)
        </td>
        <td>
          {{bio.MSIS.perc}}%
        </td>
      </tr>
      {% endif %}
      {% if "MSIP" in bio %}
      <tr>
        <td>
          MSI(Paired)
        </td>
        <td>
          {{bio.MSIP.perc}}%
        </td>
      </tr>
      {% endif %}
      {% if "HRD" in bio %}
      <tr>
        <td>
          HRD
        </td>
        <td>
          {{bio.HRD.sum}}
        </td>
      </tr>
      {% endif %}
    {% endfor %}
    {% else %}
    <tr>
      <td>
        Inga biomarkörer uppmätta
      </td>
      <td>
        -
      </td>
    </tr>
    {% endif %}

  </table>
{% endif %}
{% endif %}
<span class="report_header">Slutsats</span>
<div class="conclusion">
<div class="results_summary">
{% if sample.comments|length > 0 %}
  {% for comment in sample.comments if comment.hidden != 1 %}
    {% if loop.last %}
      {{ comment.text|format_comment|safe }}
    {% endif %}
  {% endfor %}
{% else %}
Slutsats saknas!
{% endif %}
</div>
</div>

<p style="page-break-before: always;"></p>
<br>
<span class="report_header">Detekterade varianter</span>
{% for var in variants|sort( attribute='classification.class' )  if (var.INFO.selected_CSQ.SYMBOL in dispgenes or dispgenes|length == 0) and not var.blacklist and var.classification.class != 4 and var.classification.class != 999 and not (assay == "gmsonco" and var.classification.class == 3)  %}

  {% set csq = var.INFO.selected_CSQ %}

<div class=report_div style="page-break-inside:avoid;">
  <table class='report_variant'>
    <tr>
      <th class="report_variant_header" colspan=6>
	{% set indel_size = var.ALT|length - var.REF|length %}
	{% if indel_size > 10 or indel_size < -10 %}
	<span class="report_variant_header">{{ csq.SYMBOL}}: {{ indel_size }} bp {% if indel_size < 0 %}DEL{% else %}INS{% endif %}
	{% elif csq.HGVSp|length > 0 %}
	<span class="report_variant_header">{{ csq.SYMBOL }}: {{ csq.HGVSp|one_letter_p|unesc }}</span><br>
	{% elif csq.HGVSc|length > 0 %}
	<span class="report_variant_header">{{ csq.SYMBOL }}: {{ csq.HGVSc|unesc }}</span><br>
	{% elif var.INFO.SVTYPE is defined %}
	<span class="report_variant_header">{{ csq.SYMBOL }}: {{ var.INFO.SVLEN }} bp {{ translation[var.INFO.SVTYPE] }}</span><br>
	{% else %}
	{#{ var.INFO }#}
	{% endif %}
      </th>
    </tr>
    <tr>
      <td class="report_key">Gen</td>
      <td class="var_report_val">{{ csq.SYMBOL }}</td>
      
      <td class="report_key">Typ</td>
      {% if var.INFO.MYELOID_GERMLINE == 1 or "GERMLINE" in var.FILTER %}
      <td class="var_report_val">Konstitutionell {{ csq.VARIANT_CLASS }}</td>
      {% else %}
      <td class="var_report_val">Somatisk {{ csq.VARIANT_CLASS }}</td>
      {% endif %}

      <td class="report_key">Transkript</td>
      {% set exon_info = csq.EXON.split('/') %}
      <td class="var_report_val">{{ csq.Feature }}, exon {{ exon_info[0] }}</td>
           
    </tr>
    <tr>

      <td class="report_key">Konsekvens</td>

      <td class="var_report_val">
      {% if csq.Consequence is iterable and csq.Consequence is not string %}	
        {% for conseq in csq.Consequence %}
          {% if conseq in translation %}
            {{ translation[conseq] }}<br>
          {% else %}
            {{ conseq }}<br>
          {% endif %}
        {% endfor %}
      
      {% else %}
        {% set all_conseq = csq.Consequence.split('&') %}
	
        {% for conseq in all_conseq %}
          {% if conseq in translation %}
            {{ translation[conseq] }}<br>
          {% else %}
            {{ conseq }}<br>
          {% endif %}
        {% endfor %}
      
      {% endif %}
      
      </td>

      
      <td class="report_key">cDNA-förändring</td>
      {% set indel_size = var.ALT|length - var.REF|length %}
      {% if indel_size > 20 or indel_size < -20 %}
      <td class="var_report_val">{{ indel_size }} bp {% if indel_size < 0 %}DEL{% else %}INS{% endif %}</td>
     
      {% elif csq.HGVSc|length > 0 %}
      <td class="var_report_val"><div class="wrapping">{{ csq.HGVSc|unesc }}</div></td>
      {% elif var.INFO.SVTYPE is defined %}
      <td class="var_report_val">{{ var.INFO.SVLEN }} bp {{ translation[var.INFO.SVTYPE] }}</td>
      {% else %}
      <td class="var_report_val"></td>
      {% endif %}

      <td class="report_key">Proteinförändring</td>
      <td class="var_report_val">
        {% if indel_size <= 20 and indel_size >= -20 %}
          {% if csq.HGVSp %}
            {{ csq.HGVSp|one_letter_p|unesc|safe }}<br>
            {{ csq.HGVSp|unesc|safe }}
          {% else %}
            {{ csq.HGVSp|one_letter_p|unesc }}<br>
            {{ csq.HGVSp|safe }}
          {% endif %}
        {% endif %}</td>

    </tr>
    <tr>
      <td class="report_key">Kromosom</td>
      <td class="var_report_val">chr{{ var.CHROM }}</td>

      <td class="report_key">Position (hg38)</td>
      <td class="var_report_val">{{ var.POS }}</td>

      <td class="report_key">Frekvens</td>
      <td class="var_report_val">
	{% if var.INFO.SVTYPE is defined and csq.SYMBOL == "FLT3" %}
	  N/A
	{% else %}
	  {% for gt in var.GT|sort(attribute='sample') %}
	    {% if gt.type == "case" %}
	      {{ gt.AF|perc_no_dec }}% ({{gt.DP|int}}x)
            {% endif %}
          {% endfor %}
	{% endif %}
      </td>

      
    </tr>
      

    
    {% if var.classification.class != 999 %}
    <tr>
      <td class="report_key">
	Klassificering
      </td>
      <td class="report_annotation" colspan=5>
	{% if germline %}
	  {% if var.classification.class == 1 %}
	  5 (Patogen)
	  {% endif %}
	{% else %}
	{{ var.classification.class|format_tier }} - 
        {{ class_desc[var.classification.class] }}<br>
	{% endif %}
      </td>
    {% endif %}
    
    {% if var.global_annotations|length > 0 %}    
    <tr>
      <td class="report_key">
	Kommentar
      </td>
      
      {% if var.annotations_interesting|length > 0 %}
        {% for assay_sub, key in var.annotations_interesting.items() %}    
        <td class="report_annotation" colspan=5>
          {{ key.text|format_comment|safe }}
        </td>
        {% endfor %}
      {% else %}
      {% set sorted_annos = var.global_annotations|sort(attribute="time_created", reverse=True) %}
        <td class="report_annotation" colspan=5>
          {{ sorted_annos[0].text|format_comment|safe }}
        </td>
        
      {% endif %}
      
    </tr>
    {% endif %}

    {% if var.comments|length > 0 and 1==2 %} {# DO NOT SHOW COMMENTS EVER #}
    <tr>
      <td class="report_key">
	Kommentar
      </td>
      <td class="report_comment" colspan=7>
	{% for comment in var.comments %}
	<li>{{ comment.text|format_comment|safe }}
	{% endfor %}
      </td>
    </tr>
    {% endif %}

  </table>
  
</div>
{% else %}
  {% if assay == "swea" %}
     Inga avvikelser av klinisk signifikans har påvisats.
    <br>
  {% else %}
    Inga varianter detekterade<p><p>
  {% endif %}
  
{% endfor %}

<span class="report_header">Analysbeskrivning</span>
<div class="analysis_description">

  {% if assay == "swea" %}

  <b>Testmetod:</b> Paired-end sekvensering (Illumina) av en lokalt framtagen genpanel (SWEA, Agilent SureSelect custom panel). Den aktuella analysen täcker majoriteten av kända patogena varianter i de analyserade generna, inklusive större deletioner och duplikationer (CNVs). Sekvensvarianter vilka tolkas som benigna, sannolikt benigna eller av oklar klinisk signifikans rapporteras ej. Framtida kunskap kan komma att modifiera aktuell tolkning.<br><br>
  <b>Referenstranskript:</b> BRCA1 NM_007294.3, BRCA2 NM_000059.3<br>

  {% elif assay == "gmsonco" %}
  Paired-end sekvensering (Illumina) av en lokalt framtagen genpanel (Ärftlig solid cancer v1.0, Twist custom panel). Den aktuella analysen täcker majoriteten kända patogena varianter i de analyserade generna som associerats med ärftligt förhöjd risk för cancersjukdomar, inklusive större deletioner och duplikationer (CNVs). Sekvensvarianter vilka tolkas som benigna, sannolikt benigna eller av oklar klinisk signifikans rapporteras ej. Framtida kunskap kan komma att modifiera aktuell tolkning.
  
  {% elif germline %}
  DNA har extraherats från insänt prov (vanligtvis färskt benmärgsprov, blodprov och odlad hudbiopsi) och analyserats med massiv parallell sekvensering (MPS, även kallat NGS). Sekvensanalysen omfattar exoner och hotspot-regioner i 54 gener som inkluderas i Illuminas TruSight Myeloid sekvenseringspanel. (https://www.illumina.com/products/by-type/clinical-research-products/trusight-myeloid.html#gene-list). Analysen avser förvärvad variant där hudbiopsi används som kontrollmaterial. Som krav för godkänd sekvens krävs generellt minst 100 läsningar samt en variantallelfrekvens (VAF) högre än 5% med minst 10 läsningar med variantallelen. Proverna är sekvenserade på Illumina-instrument.  

  {% elif "gms_myeloid" in group or "myeloid_GMSv1" in group %}  
  DNA har extraherats från insänt prov (vanligtvis färskt benmärgsprov, blodprov samt odlad hudbiopsi) och analyserats med massiv parallell sekvensering (MPS, även kallat NGS). Sekvensanalysen omfattar exoner i 191 gener som inkluderas i GMS-myeloid v1.0 sekvenseringspanelen (Tabell 1). Analysen  kan även innefatta regioner över utvalda SNPs som möjliggör en lågupplöst detektion av stora (>10 Mb) genomiska obalanser såsom -5 eller del(5q), -7 samt -17/del(17p).
<p>
  Analysen avser somatiska detektion av varianter i samtliga 191 gener (en korresponderande hudbiopsi används som kontrollmaterial). För CEBPA undersöks även konstitutionella varianter. Vid avsaknad av kontrollmaterial undersöks endast ett begränsat antal gener enligt fördefinierade genlistor för AML (NPM1, CEBPA, FLT3), MPN (JAK2, CALR, MPL) samt KLL (TP53, NOTCH1, SF3B1). Analysen avser detektion av SNVs som förändrar aminosyrasekvensen i exon samt i regioner som påverkar splicing, små insertioner/deletioner (upp till runt 20-50 bp) samt FLT3-ITD.  Som krav för godkänd sekvens krävs generellt en medeltäckning på 1000x (1000 läsningar över en position i genomet). Då kraven på godkänd sekvens uppfylls ligger metodens känslighet på en variantallelfrekvens (VAF) på ≥ 3 %. Proverna är sekvenserade på Illumina-instrument. Somatiskt detekterade varianter klassas som Tier I, II, III eller IV enligt riktlinjer för tolkning och rapportering av sekvens varianter inom cancer (Tabell 2). [1] Tier IV varianter rapporteras inte ut.

<p> <b>Tabell 1: Gener inkluderade i GMS-myeloid v1.0</b><p>
    <table class="genetable"><tr><td>ABL1</td><td>AKT1</td><td>ALK</td><td>ANKRD26</td><td>ARHGEF10</td><td>ARID1A</td><td>ARID2</td><td>ASXL1</td><td>ASXL2</td><td>ATRX</td><td>BAP1</td><td>BCL10</td><td>BCL11B</td><td>BCL2</td><td>BCOR</td></tr>
      <tr><td>BCORL1</td><td>BRAF</td><td>BRCC3</td><td>BTG1</td><td>BTK</td><td>CALR</td><td>CBL</td><td>CBLB</td><td>CCND3</td><td>CDK4</td><td>CDKN1B</td><td>CDKN2A</td><td>CDKN2B</td><td>CDKN2C</td><td>CEBPA</td></tr>
      <tr><td>CHD4</td><td>CHEK2</td><td>CNOT3</td><td>CREBBP</td><td>CRLF2</td><td>CSF1R</td><td>CSF2RB</td><td>CSF3R</td><td>CSNK1A1</td><td>CTCF</td><td>CTNNB1</td><td>CUX1</td><td>CXCR4</td><td>DCC</td><td>DDX23</td></tr>
      <tr><td>DDX3X</td><td>DDX4</td><td>DDX41</td><td>DDX54</td><td>DHX15</td><td>DHX33</td><td>DICER1</td><td>DNM2</td><td>DNMT3A</td><td>DNMT3B</td><td>EBF1</td><td>EED</td><td>EGFR</td><td>EP300</td><td>ETNK1</td></tr>
      <tr><td>ETV6</td><td>EZH2</td><td>FAM175A</td><td>FBXW7</td><td>FGFR2</td><td>FLT3</td><td>GATA1</td><td>GATA2</td><td>GFI1</td><td>GIGYF2</td><td>GNAS</td><td>GNB1</td><td>H3F3A</td><td>H3F3B</td><td>HIPK2</td></tr>
      <tr><td>HRAS</td><td>IDH1</td><td>IDH2</td><td>IKZF1</td><td>IL7R</td><td>INO80</td><td>IRF1</td><td>IRF4</td><td>IRF8</td><td>JAK1</td><td>JAK2</td><td>JAK3</td><td>JARID2</td><td>KDM5C</td><td>KDM6A</td></tr>
      <tr><td>KIT</td><td>KRAS</td><td>LEF1</td><td>LUC7L2</td><td>MED12</td><td>MGA</td><td>MLL</td><td>MLL2</td><td>MLL3</td><td>MPL</td><td>MYB</td><td>MYC</td><td>MYCN</td><td>MYD88</td><td>NF1</td></tr>
      <tr><td>NF2</td><td>NFE2</td><td>NFE2L2</td><td>NIPBL</td><td>NOTCH1</td><td>NOTCH2</td><td>NPM1</td><td>NRAS</td><td>NT5C2</td><td>NXF1</td><td>PAX5</td><td>PDGFRA</td><td>PHF6</td><td>PHIP</td><td>PIK3CA</td></tr>
      <tr><td>PIK3CD</td><td>PIK3R1</td><td>PLCG2</td><td>PPM1D</td><td>PRPF40A</td><td>PRPF40B</td><td>PRPF8</td><td>PTEN</td><td>PTPN11</td><td>PTPRF</td><td>RAC1</td><td>RAD21</td><td>RAD50</td><td>RAD51</td><td>RASGRF1</td></tr>
      <tr><td>RB1</td><td>RHOA</td><td>RIT1</td><td>ROBO1</td><td>ROBO2</td><td>RPL10</td><td>RPL22</td><td>RPL5</td><td>RRAS</td><td>RUNX1</td><td>SAMD9</td><td>SAMD9L</td><td>SAMHD1</td><td>SBDS</td><td>SETBP1</td></tr>
      <tr><td>SETD2</td><td>SETDB1</td><td>SF1</td><td>SF3A1</td><td>SF3B1</td><td>SH2B3</td><td>SMARCA4</td><td>SMC1A</td><td>SMC3</td><td>SMG1</td><td>SPRED2</td><td>SRCAP</td><td>SRP72</td><td>SRSF2</td><td>STAG1</td></tr>
      <tr><td>STAG2</td><td>STAT3</td><td>STAT5A</td><td>STAT5B</td><td>SUZ12</td><td>TBL1XR1</td><td>TET2</td><td>TOX</td><td>TP53</td><td>TRRAP</td><td>U2AF1</td><td>U2AF2</td><td>UBA2</td><td>USH2A</td><td>USP7</td></tr>
      <tr><td>USP9X</td><td>WHSC1</td><td>WT1</td><td>YLPM1</td><td>ZBTB33</td><td>ZBTB7A</td><td>ZEB2</td><td>ZMYM3</td><td>ZNF318</td><td>ZRSR2</td><td>TERT</td></tr>
    </table>
    
  
{% elif "solid_GMSv3" in group %}
DNA har extraherats från insänt prov (vanligtvis paraffininbäddad formalinfixerad vävnad, men även färsk vävnad, cytologi- och blodprov förekommer) och analyserats med massiv parallell sekvensering (MPS även kallat NGS) med en nationellt framtagen genpanel för solida tumörer (GMS-Solid v3.0, se nationell valideringsrapport). Sekvensanalysen med diagnosspecifik genlista (se tabell 1) omfattar exoner och hotspot-regioner i cancerassocierade gener som bedöms vara av klinisk relevans samt finns med i de nationella vårdprogrammen och/eller ESCAT. 
<p>Analysen avser somatiska förändringar, SNV, INDEL, kopietalförändringar och fusioner i gener som har rapporterats vara av behandlingsstyrande, diagnostisk och/eller prognostisk betydelse för respektive tumörsjukdom. De klassas som Tier I eller II enligt klassningssystemet nedan och svaras ut då variantallelfrekvensen (VAF) är ≥ 3 %. Proverna är sekvenserade på Illumina-instrument.
<p> <b>Tabell 1: Gener inkluderade i GMS-solid v3.0 med genlista/genlistor {{checked_genelists|join(', ')}}</b><p>
  <table class="genetable">
  {% if dispgenes|length > 0 %}
  
    {% set CL = 0 %}
    {% for gene in dispgenes %}
      {% set CL = CL+1 %}
      {% if CL == 10 %}
        {% set CL = 1 %}
        <tr></tr>
      {% endif %}
      <td>{{gene}}</td>
      
    {% endfor %}
    {% else %}
    <tr><td>Ingen genlista vald, samtliga 560 gener har undersökts</td></tr>
    {% endif %}
  </table>

{% else %}
DNA har extraherats från insänt prov (vanligtvis färskt benmärgsprov, blodprov och odlad hudbiopsi) och analyserats med massiv parallell sekvensering (MPS, även kallat NGS). Sekvensanalysen omfattar exoner och hotspot-regioner i 54 gener som inkluderas i Illuminas TruSight Myeloid sekvenseringspanel. (<a href="https://www.illumina.com/products/by-type/clinical-research-products/trusight-myeloid.html#gene-list">https://www.illumina.com/products/by-type/clinical-research-products/trusight-myeloid.html#gene-list</a>). Analysen avser somatiska varianter (hudbiopsi används som kontrollmaterial). För CEBPA undersöks även konstitutionella varianter. Regionerna över CEBPA samt FLT3 är förstärkta med PCR samt separat bibliotekspreparation (NexteraXT, Illumina).
<p>
  Analys avser somatisk detektion av SNVs som förändrar aminosyrasekvensen i exon samt i regioner som påverkar splicing, små insertioner/deletioner (upp till runt 20-50 bp) samt FLT3-ITD. För att säkerställa identifiering av de större deletioner analyseras gener med en specialiserad mjukvara (pindel). Som krav för godkänd sekvens krävs generellt minst 100 läsningar samt en variantallelfrekvens (VAF) högre än 5% med minst 10 läsningar med variantallelen. Proverna är sekvenserade på Illumina-instrument. Parad analys sker där en korresponderande hudbiopsi har inkommit som konstitutionell kontroll. Då ett korresponderande normalprov saknas svaras endast ett begränsat antal detekterade varianter ut (avgörs av frågeställning). Somatiska detekterade varianter inom Tier I-III rapporteras, Tier IV varianter rapporteras inte[1].
{% endif %}

{% if not germline %}
<p>
{% if "gms_myeloid" in group or "myeloid_GMSv1" in group or "solid_GMSv3" in group %}
 <b>Tabell 2: Förklaring av klassificering</b><p>
{% else %}
 <b>Tabell: Förklaring av klassificering</b><p>
{% endif %}
<table class="info">
  {% if "solid_GMSv3" in group %}
  <tr><td>Tier I</td> <td>Variant av stark klinisk signifikans (genvarianter som är diagnostiska, behandlingsstyrande eller riskstratifierande enligt gällande riktlinjer)</td></tr>
  {% else %}
  <tr><td>Tier I</td> <td>Variant av stark klinisk signifikans (genvarianter som är diagnostiska, behandlingsstyrande eller riskstratifierande enligt gällande riktlinjer)</td></tr>
  {% endif %}
  <tr><td>Tier II</td> <td>Variant av potentiell klinisk signifikans (varianter i gener beskrivna i ett flertal publikationer)</td></tr>
  <tr><td>Tier III</td> <td>Variant av oklar klinisk signifikans (varianter i gener beskrivna i ett fåtal publikationer)</td></tr>
  <tr><td>Tier IV</td> <td>Variant bedömd som benign eller sannolikt benign</td></tr>
</table>    

<p>
<b>Referenser</b><p>
[1] Standards and guidelines for the interpretation and reporting of sequence variants in cancer. Li et al, Journal of Molecular Diagnostics, 2017.
{% endif %}
</div>

<script>
  var expanded = false;
  function showCheckboxes() {
    var checkboxes = document.getElementById("checkboxes");
    if (!expanded) {
      checkboxes.style.display = "block";
      expanded = true;
    } else {
      checkboxes.style.display = "none";
      expanded = false;
    }
  }

  function show_lowcov() {
    if( document.getElementById("lowcovlist_div").style.display == "none" ) {
       document.getElementById("lowcovlist_div").style.display="inline";
    }
    else {
       document.getElementById("lowcovlist_div").style.display="none";
    }
  }

</script>

<style>
  .multiselect {
    width: 100%;
  }
  .selectBox {
    position: relative;
  }
  .selectBox select {
    width: 100%;
  }
  .overSelect {
    position: absolute;
    left: 0; right: 0; top: 0; bottom: 0;
  }
  #checkboxes {
    display: none;
    border-bottom: 1px #bbb solid;
    border-left: 1px #bbb solid;
    border-right: 1px #bbb solid;
    border-radius: 0px 0px 3px 3px;
    background-color: #fff;
  }
  #checkboxes label {
    display: block;
  }
  #checkboxes label:hover {
    background-color: #f7f7ff;
  }
</style>

{% endblock %}



