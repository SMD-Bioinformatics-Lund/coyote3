{% extends "layout.html" %}

{% block title %}Docs{% endblock %}

{% block meta %}
  <meta name="description" content="Internal documentation for Coyote3.">
{% endblock %}

{% block body %}
<div class="w-full h-full overflow-y-auto bg-gray-50">

  <!-- Header -->
  <header class="mx-auto max-w-7xl px-4 pt-6">

    <div class="flex flex-wrap items-start justify-between gap-4">
      <div>
        <h1 class="text-3xl font-semibold tracking-wide">Documentation</h1>
        <p class="mt-2 max-w-3xl text-base">
          Internal documentation for Coyote3 features, workflows, and system behavior.
        </p>
      </div>

      <a href="{{ url_for('dashboard_bp.dashboard') }}"
         class="inline-flex items-center gap-2 rounded-3xl border border-blue-300 bg-blue-200 px-3 py-2 text-sm font-medium shadow-xl hover:shadow-sm">
        <img src="{{ url_for('static', filename='icons/heroicons_outline_24/arrow-uturn-left.svg') }}"
             alt="Back" class="h-4 w-4">
        Back to Dashboard
      </a>
    </div>
  </header>

  <!-- Content -->
  <main class="mx-auto max-w-7xl px-4 pb-16 mt-6 space-y-6">
    <section class="rounded-3xl border-t-4 border-blue-400 bg-white shadow-2xl p-6">
      <h2 class="text-sm font-semibold">Search Handbook</h2>
      <p class="mt-2 text-sm max-w-2xl">
        Search documentation by keyword to find the right module quickly.
      </p>
      <form method="GET" action="{{ url_for('docs_bp.docs_index') }}" class="mt-4 flex gap-2">
        <input
          type="text"
          name="q"
          value="{{ q or '' }}"
          placeholder="Search docs (example: matrix, catalog, variant search, aspc)"
          class="w-full rounded-xl border border-gray-300 px-3 py-2 text-sm"
        >
        <button
          type="submit"
          class="rounded-xl border border-blue-300 bg-blue-200 px-4 py-2 text-sm font-semibold"
        >
          Search
        </button>
      </form>

      {% if q %}
        <div class="mt-4 text-xs text-gray-600">
          {{ search_count }} result(s) for "<span class="font-mono">{{ q }}</span>"
        </div>
      {% endif %}

      {% if search_results %}
        <div class="mt-4 space-y-3">
          {% for r in search_results %}
            <a
              href="{{ url_for('docs_bp.docs_page', doc_path=r.doc_path) }}"
              class="block rounded-xl border border-gray-200 p-3 hover:bg-gray-50"
            >
              <div class="text-sm font-semibold">{{ r.title }}</div>
              <div class="text-xs text-gray-600 mt-1">{{ r.doc_path }}</div>
              <div class="text-xs text-gray-700 mt-2">{{ r.snippet }}...</div>
            </a>
          {% endfor %}
        </div>
      {% endif %}
    </section>

    <!-- Handbook card -->
    <section class="rounded-3xl border-t-4 border-gray-400 bg-white shadow-2xl p-6 hover:shadow-lg hover:bg-gray-50 transition duration-500">
      <h2 class="text-sm font-semibold">Handbook Links</h2>
      <p class="mt-2 text-sm max-w-2xl">
        Open the handbook track you need:
      </p>

      <ul class="mt-3 list-disc pl-5 text-sm space-y-1">
        <li>User handbook: day-to-day operation and workflows</li>
        <li>Developer handbook: technical internals and implementation guides</li>
      </ul>

      <p class="mt-4 text-xs text-gray-600">
        The handbook is rendered from markdown under <span class="font-mono">docs/handbook</span>.
      </p>

      <div class="mt-4 flex flex-wrap gap-2">
        <!-- User handbook -->
        <a href="{{ url_for('docs_bp.docs_user_index') }}"
           class="inline-flex items-center gap-2 rounded-3xl bg-gray-200 px-3 py-2 text-sm font-medium text-black shadow-lg border-l-8 border-blue-500 hover:bg-blue-500 transition duration-300 hover:text-white">
           User Docs
        </a>

        {% if has_access("delete_sample_global", min_role="developer", min_level=9999) %}
          <!-- Developer handbook -->
          <a href="{{ url_for('docs_bp.docs_developer_index') }}"
            class="inline-flex items-center gap-2 rounded-3xl bg-gray-200 px-3 py-2 text-sm font-medium text-black shadow-lg border-l-8 border-indigo-500 hover:bg-indigo-500 transition duration-300 hover:text-white">
            Developer Docs
          </a>
        {% endif %}

        <!-- About -->
        <a href="{{ url_for('docs_bp.about') }}"
           class="inline-flex items-center gap-2 rounded-3xl bg-gray-200 px-3 py-2 text-sm font-medium text-black shadow-lg border-l-8 border-blue-400 hover:bg-blue-400 transition duration-300 hover:text-white">
          About
        </a>

        <!-- Changelog -->
        <a href="{{ url_for('docs_bp.changelog') }}"
           class="inline-flex items-center gap-2 rounded-3xl bg-gray-200 px-3 py-2 text-sm font-medium text-black shadow-lg border-l-8 border-indigo-400 hover:bg-indigo-400 transition duration-300 hover:text-white">
          Changelog
        </a>

        <!-- License -->
        <a href="{{ url_for('docs_bp.license') }}"
           class="inline-flex items-center gap-2 rounded-3xl bg-gray-200 px-3 py-2 text-sm font-medium text-black shadow-lg border-l-8 border-green-400 hover:bg-green-400 transition duration-300 hover:text-white">
          License
        </a>

        <!-- README (external) -->
        {% if config.README_URL %}
          <a href="{{ config.README_URL }}"
            target="_blank" rel="noopener"
            class="inline-flex items-center gap-2 rounded-3xl bg-gray-200 px-3 py-2 text-sm font-medium text-black shadow-lg border-l-8 border-purple-400 hover:bg-purple-400 transition duration-300 hover:text-white">
            README
          </a>
        {% endif %}

        <!-- Code of Conduct -->
        {% if config.CODE_OF_CONDUCT_URL %}
          <a href="{{ config.CODE_OF_CONDUCT_URL }}"
            target="_blank" rel="noopener"
            class="inline-flex items-center gap-2 rounded-3xl bg-gray-200 px-3 py-2 text-sm font-medium text-black shadow-lg border-l-8 border-yellow-600 hover:bg-yellow-600 transition duration-300 hover:text-white">
            Code of Conduct
          </a>
        {% endif %}

        <!-- Security -->
        {% if config.SECURITY_URL %}
          <a href="{{ config.SECURITY_URL }}"
            target="_blank" rel="noopener"
            class="inline-flex items-center gap-2 rounded-3xl bg-gray-200 px-3 py-2 text-sm font-medium text-black shadow-lg border-l-8 border-red-400 hover:bg-red-400 transition duration-300 hover:text-white">
            Security
          </a>
        {% endif %}

        <!-- Contributing -->
        {% if config.CONTRIBUTING_URL %}
          <a href="{{ config.CONTRIBUTING_URL }}"
            target="_blank" rel="noopener"
            class="inline-flex items-center gap-2 rounded-3xl bg-gray-200 px-3 py-2 text-sm font-medium text-black shadow-lg border-l-8 border-pink-400 hover:bg-pink-400 transition duration-300 hover:text-white">
            Contributing
          </a>
        {% endif %}
      </div>
    </section>

  </main>
</div>
{% endblock %}
